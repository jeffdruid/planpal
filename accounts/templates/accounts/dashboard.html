{% extends 'base.html' %}

{% block title %}Dashboard{% endblock %}

{% block content %}

<div class="dashboard-container">
    <div class="upcoming-events">
        <h3>Upcoming Events</h3>
        <ul>
            {% for event in upcoming_events %}
                <li>
                    <strong><a href="{% url 'event_details' event.id %}" class="event-link">{{ event.title }}</a></strong> - {{ event.proposed_date|date:"F j, Y" }} - <span class="status {{ event.status|lower }}">{{ event.status }}</span>
                </li>
            {% empty %}
                <li>No upcoming events.</li>
            {% endfor %}
        </ul>
    </div>

    <div id="calendar"></div>

    <div class="your-events">
        <h3>Your Events</h3>
        <ul>
            {% for event in user_events %}
                <li>
                    <a href="{% url 'event_details' event.id %}" class="event-link">
                        <strong>{{ event.title }}</strong>
                    </a>
                    - {{ event.proposed_date|date:"F j, Y" }}
                    <span class="status {{ event.status|lower }}">{{ event.status }}</span>
                    <a href="{% url 'edit_event' event.id %}" class="edit-btn">Edit</a>
                    <button class="delete-btn">Delete</button>
                </li>
            {% empty %}
                <li>You have not created any events.</li>
            {% endfor %}
        </ul>
        <a href="{% url 'create_event' %}" class="add-btn">Create Event</a>
    </div>
</div>

<script>
    $(document).ready(function() {
        $('#calendar').fullCalendar({
            header: {
                left: 'prev,next today',
                center: 'title',
                right: 'month,agendaWeek,agendaDay'
            },
            editable: false,
            events: [
                {% for event in upcoming_events %}
                    {
                        title: '{{ event.title }}',
                        start: '{{ event.proposed_date|date:"Y-m-dTH:i:s" }}',
                        className: '{{ event.status|lower }}-event',
                        url: '{% url "event_details" event.id %}'
                    },
                {% endfor %}
            ]
        });
    });
</script>

{% endblock %}
